<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>公司详情</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<script type="text/javascript" src="../js/zoom/flexible.js"></script>
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/style.css" />
		<style>
			.mui-content {
				padding-bottom: 0.538rem;
			}
			
			.right-update {
				width: 0.611rem;
				height: 0.583rem;
				margin-right: 0.778rem;
			}
			
			.right-edit {
				width: 0.514rem;
				height: 0.569rem;
			}
			
			.content-body {
				position: relative;
				padding-top: 1.594rem;
				width: 92.22%;
				margin: 0 auto;
				z-index: 999;
			}
			
			.card-bg {
				width: 100%;
				min-height: 3.778rem;
				background-color: #ffffff;
				box-shadow: 0rem 0.028rem 0.375rem 0.042rem rgba(183, 183, 183, 0.3);
				border-radius: 0.417rem;
				position: relative;
			}
			
			.title-avatar-bg {
				justify-content: center;
				align-items: center;
				border-radius: 90px;
				width: 2.5rem;
				height: 2.5rem;
				margin: 0 auto;
				background-color: rgba(255, 255, 255, 0.4);
				position: absolute;
				top: 0;
				transform: translateY(-50%);
				-webkit-transform: translateY(-50%);
				left: 1.028rem;
				z-index: 999;
				display: flex;
			}
			
			.title-avatar {
				width: 2.222rem;
				height: 2.222rem;
				border-radius: 90px;
				display: flex;
				justify-content: center;
				align-items: center;
				font-size: 0.583rem;
				color: #ffffff;
			}
			
			.title-avatar img {
				width: 100%;
				height: 100%;
			}
			
			.card-name {
				text-align: center;
				padding: 0.778rem;
				font-size: 0.5rem;
				color: #2f303a;
				padding-left: 3.528rem;
			}
			
			.name-surname {
				font-size: 0.583rem;
				color: #46495b;
				margin-left: 0.403rem;
			}
			
			.card-post {
				font-size: 0.389rem;
				color: #05b9fc;
				margin-left: 0.208rem;
			}
			
			.card-record ul {
				display: flex;
				padding-top: 0.097rem;
				padding-bottom: 0.583rem;
			}
			
			.card-record li {
				flex: 1;
				text-align: center;
				font-size: 0.483rem;
				color: #fb8538;
			}
			
			.record-character {
				font-size: 0.444rem;
				color: #46495b;
				margin-top: 0.583rem;
			}
			/*标签*/
			
			.body-title-tag {
				height: 1.25rem;
				margin: 0 auto;
				background-color: #ffffff;
				box-shadow: 0rem 0.028rem 0.375rem 0.042rem rgba(183, 183, 183, 0.3);
				border-radius: 0.417rem;
				display: flex;
				margin-bottom: 0.389rem;
				position: relative;
				margin-top: 0.389rem;
				margin-bottom: 0.403rem;
			}
			
			.nav-tag {
				width: 100%;
				display: flex;
				align-items: center;
			}
			
			.tag-items {
				width: 80%;
				margin-left: 5%;
			}
			
			.tag-text {
				width: 15%;
				display: inline-flex;
				justify-content: center;
				align-items: center;
			}
			
			.tag-text img {
				width: 0.444rem;
				height: 0.444rem;
			}
			/*图片轮播样式调整*/
			
			.mui-slider-image {
				position: relative;
				width: 107.78%;
				margin-left: -3.89%;
				background-image: none;
				background-color: rgba(0, 0, 0, 0);
				overflow: hidden;
			}
			
			.body-title {
				position: relative;
				z-index: 9;
				margin: 0 5%;
				height: 2.486rem;
				background-color: #ffffff;
				box-shadow: 0rem 0.028rem 0.375rem 0.042rem rgba(183, 183, 183, 0.3);
				border-radius: 0.417rem;
				display: flex;
				align-items: center;
			}
			
			.mui-slider .mui-slider-group .mui-slider-item {
				width: 70%;
			}
			
			.item-img {
				width: 50%;
				height: 2.125rem;
				background-color: #937d5b;
				border-radius: 0.278rem;
				margin: 0 0.181rem;
			}
			
			.item-text {
				width: 50%;
			}
			
			.item-text-title {
				text-align: center;
				font-size: 0.444rem;
				color: #2f303a;
			}
			
			.item-text-company {
				text-align: center;
				font-size: 0.333rem;
				margin-top: 0.175rem;
				padding-right: 1%;
			}
			/*列表*/
			
			.edit-bg {
				position: relative;
				margin-top: 0.389rem;
				z-index: 99;
				font-size: 0.389rem;
				color: #46495b;
				background-color: #ffffff;
				box-shadow: 0rem 0.028rem 0.375rem 0.042rem rgba(183, 183, 183, 0.3);
				border-radius: 0.417rem;
			}
			
			.edit-bg li {
				display: flex;
				align-items: center;
				min-height: 1.25rem;
			}
			
			.edit-bg li:last-child {
				border-bottom: none;
			}
			
			.delete-btn {
				width: 0.333rem !important;
				height: 0.333rem !important;
				margin-top: 0 !important;
			}
			
			.edit-left-box {
				width: 100%;
				min-height: 1.25rem;
				padding-left: 5%;
				/*padding-top: 0.138rem;*/
				border-bottom: 0.028rem solid #f1f1f1;
				display: inline-flex;
				align-items: center;
			}
			
			.edit-left-box:last-child {
				border-bottom: none;
			}
			
			.edit-left-box input {
				padding: 0;
				margin: 0;
				border: none;
				text-align: right;
			}
			
			.edit-left-content {
				padding: 2% 5%;
				margin: 0;
				width: 100%;
			}
			
			.edit-left-text {
				padding: 0.138rem 0;
				padding-right: 5%;
			}
			
			.edit-left-edit {
				border: none;
				padding: 0.138rem 0;
				padding-right: 5%;
				margin: 0;
				min-height: 1.25rem;
				background-color: rgba(0, 0, 0, 0);
			}
			
			.edit-left {
				width: 30%;
				min-height: 1.25rem;
				display: inline-flex;
				align-items: center;
				color: #46495b;
			}
			
			.edit-right {
				width: 70%;
				min-height: 1.25rem;
				line-height: 0.67rem;
				display: inline-flex;
				align-items: center;
				flex-direction: row-reverse;
				text-align: right;
				padding-right: 5%;
				color: #2f303a;
			}
			
			.edit-icon {
				width: 15%;
				height: 1.25rem;
				display: inline-flex;
				align-items: center;
				justify-content: left;
				font-size: 0.388rem;
				color: #05b9fc;
			}
			
			.edit-icon img {
				width: 0.444rem;
				height: 0.389rem;
				margin-top: -0.038rem;
			}
			
			.visit-edit {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 0 5%;
				margin-top: 0.389rem;
				height: 1.167rem;
				background-image: linear-gradient( #8a63c1, #8a63c1), linear-gradient( #8a63c1, #8a63c1);
				background-blend-mode: normal, normal;
				box-shadow: 0rem 0.028rem 0.375rem 0.042rem rgba(183, 183, 183, 0.3);
				border-radius: 0.417rem;
				font-size: 0.389rem;
				color: #ffffff;
			}
			
			.visit-right img {
				width: 0.444rem;
				height: 0.444rem;
				margin-top: 0.138rem;
			}
			
			.look-more {
				text-align: center;
				height: 1.139rem;
				line-height: 1.139rem;
				font-size: 0.389rem;
				color: #05b9fc;
			}
			
			.look-more img {
				width: 0.167rem;
				height: 0.306rem;
				margin-left: 0.194rem;
			}
			/*点击样式*/
			
			.right-update:active {
				opacity: 0.5;
			}
			
			.right-edit:active {
				opacity: 0.5;
			}
			
			.tag-text:active {
				opacity: 0.5;
			}
			
			.edit-icon:active {
				color: #000000;
			}
			
			.visit-right:active {
				opacity: 0.5;
			}
		</style>
	</head>

	<body>
		<header class="main-header" id="header">
			<div class="header-left mui-action-back">
				<img align="center" class="mui-action-back" src="../images/back.png" /> 公司详情
			</div>
			<div class="header-right">
				<img class="right-update" align="center" src="../images/selfCard/synchronization.png" />
				<img class="right-edit" align="center" src="../images/selfCard/edit.png" />
			</div>
		</header>

		<div class="mui-content" id="content">
			<div class="body-bg"></div>
			<div class="content-body">
				<div class="card-bg">
					<div class="title-avatar-bg">
						<div class="title-avatar">
							<img src="../images/mySelf/head.png" />
						</div>
					</div>

					<div class="card-name" v-text="dataList.companyName"></div>

					<div class="card-record">
						<ul>
							<li>
								<div v-if="dataList.people" v-text="dataList.people.length"></div>
								<div class="record-character">名片数</div>
							</li>
							<li>
								<div v-text="visitList.length || 0"></div>
								<div class="record-character">拜访次数</div>
							</li>
							<li>
								<div>会员</div>
								<div class="record-character">会员状态</div>
							</li>
						</ul>
					</div>
				</div>

				<!--标签-->
				<div class="body-title-tag">
					<nav class="nav-tag">
						<div class="tag-items">
							<div id="slider" class="mui-slider slider-card">
								<div class="mui-scroll-wrapper scroll-wrapper-tag mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
									<div class="mui-scroll mui-scroll-tag">
										<ul>
											<div v-for="tagItem in tag" class="tag-items-li" :class="tagItem.index | tagItem" v-text="tagItem.text"></div>
											<!--<div class="tag-items-li tag-item-1">会员</div>-->
										</ul>
									</div>
								</div>
							</div>
						</div>
						<div class="tag-text">
							<img src="../images/selfCard/add_label_to.png" />
						</div>
					</nav>
				</div>

				<!--个人-->
				<div id="mui-slider-image" class="mui-slider mui-slider-image">
					<div class="mui-slider-group mui-slider-group-images">
						<!--第一个内容区容器-->
						<!--<div v-for="item in dataList.people" class="mui-slider-item mui-slider-item-images">
							<div class="body-title">
								<div class="item-img">

								</div>
								<div class="item-text">
									<div class="item-text-title">李晓明</div>
									<div class="item-text-company mui-ellipsis-1">资源对接公司资源对接公司资源对接公司资源对接公司</div>
								</div>
							</div>
						</div>-->
						<!--第二个内容区-->
						<!--<div class="mui-slider-item mui-slider-item-images">
							<div class="body-title">
								<div class="item-img">

								</div>
								<div class="item-text">
									<div class="item-text-title">李晓明</div>
									<div class="item-text-company mui-ellipsis-1">资源对接公司资源对接公司资源对接公司资源对接公司</div>
								</div>
							</div>
						</div>-->

					</div>
				</div>
				<!--公司简介-->
				<div class="edit-bg">
					<ul>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">公司简介</div>
							</div>
							<div id="edit-icon" class="edit-icon">
								展开
							</div>
						</li>
						<li>
							<div id="edit-left-content" class="edit-left-content mui-ellipsis-2" v-text="dataList.companyIntro"></div>
						</li>
					</ul>
				</div>
				<!--办公地址-->
				<div class="edit-bg">
					<ul>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">办公地址</div>
								<div class="edit-right" v-text="dataList.companySite"></div>
							</div>
						</li>
					</ul>
				</div>

				<!--企业类别-->
				<div class="edit-bg">
					<ul>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">企业类别</div>
								<div class="edit-right" v-text="dataList.companyEnterprise"></div>
							</div>
						</li>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">企业性质</div>
								<div class="edit-right" v-text="dataList.companyNature"></div>
							</div>
						</li>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">涉及领域</div>
								<div class="edit-right" v-text="dataList.companyInvolve"></div>
							</div>
						</li>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">注册时间</div>
								<div class="edit-right" v-text="dataList.companyRegister"></div>
							</div>
						</li>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">注册地点</div>
								<div class="edit-right" v-text="dataList.companyRegSite"></div>
							</div>
						</li>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">外包类型</div>
								<div class="edit-right" v-text="dataList.companyEpiboly"></div>
							</div>
						</li>
					</ul>
				</div>
				<!--公司网址-->
				<div class="edit-bg">
					<ul>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">公司网址</div>
								<div class="edit-right" v-text="dataList.companyURL"></div>
							</div>
						</li>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">位置</div>
								<div class="edit-right" v-text="dataList.companyOtherURL"></div>
							</div>
						</li>
					</ul>
				</div>
				<!--人员规模-->
				<div class="edit-bg">
					<ul>
						<li>
							<div class="edit-left-box">
								<div class="edit-left">人员规模</div>
								<div class="edit-right" v-text="dataList.companyPeople"></div>
							</div>
						</li>
					</ul>
				</div>
				<!--拜访记录-->
				<div class="edit-bg">
					<div class="visit-edit">
						<div class="visit-left">拜访记录</div>
						<div class="visit-right"><img src="../images/company/add_visit.png" /></div>
					</div>
					<ul class="visit-list">
						<li v-for="visitItem in visitList" @tap="open_detail(visitItem)">
							<div class="edit-left-box">
								<div class="edit-left" v-text="visitItem.visitGoal"></div>
								<div class="edit-right" v-text="visitItem.visitTime"></div>
							</div>
						</li>
					</ul>
					<!--查看更多-->
					<div id="look-more" v-if="visitList.length != 0" class="look-more">
						查看更多<img src="../images/mySelf/next.png" />
					</div>
				</div>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script type="text/javascript" src="../js/immersed.js"></script>
		<script type="text/javascript" src="../js/config.js"></script>
		<script type="text/javascript" src="../js/indexedDB.js"></script>
		<script type="text/javascript" src="../js/vue.min.js"></script>
		<script type="text/javascript">
			mui.init();
			var database = null;
			var type = null;

			Vue.filter('tagItem', function(value) {
				var num = Math.random();
				console.log(parseInt(num * 10 / 3 + 1))
				return 'tag-item-' + parseInt(num * 10 / 3 + 1);
			})
			var vm = new Vue({
				el: '#content',
				data: {
					dataList: '',
					tag: '',
					visitList: ''
				},
				mounted: function() {
					var that = this;
					mui.plusReady(function() {
						var self = plus.webview.currentWebview();
						var uuid = null;
						type = self.type;
						openDB(function(data) {
							if(data.type == true) {
								if(type == 'company') {
									database = JSON.parse(self.database);
									that.dataList = database;
									that.tag = database.tag;
									uuid = database.uuid;
								} else if(type == 'self') {
									uuid = self.companyUid;
									selectUidData('Company', uuid,function(companyData){
										that.dataList = companyData;
										that.tag = companyData.tag;
									})
								}
								selectOneData('Visit', "ownerIndex", uuid, function(visitData) {
									vm.visitList = visitData;
								})
							} else {
								plus.nativeUI.toast('获取数据失败！')
							}
						});

					})
				}
			});
			//名片编辑
			mui('.header-right').on('tap', '.right-edit', function() {
				openView.usuView('card_detail_edit.html', 'card_detail_edit');
			})
			//名片更新
			mui('.header-right').on('tap', '.right-update', function() {

			})
			//标签添加
			mui('.nav-tag').on('tap', '.tag-text', function() {
				//				openView.usuView('add_tag.html','add_tag');
				plus.nativeUI.toast('暂不支持修改~')
			});
			//个人名片
			mui('.mui-slider-group').on('tap', '.body-title', function() {
				openView.usuView('self_card.html', 'self_card');
			})
			//展开
			var edit_btn = document.getElementById("edit-icon");
			if(edit_btn) {
				var edit_content = document.getElementById("edit-left-content");
				edit_btn.addEventListener('tap', function() {
					//查询是否有class
					if(edit_content.classList.contains('mui-ellipsis-2')) {
						edit_content.classList.remove('mui-ellipsis-2');
						edit_btn.innerText = '收起';
					} else {
						edit_content.classList.add('mui-ellipsis-2');
						edit_btn.innerText = '展开';
					}
				})
			}
			//添加拜访记录
			mui('.visit-edit').on('tap', '.visit-right', function() {
				var companyUid = vm.dataList.uuid;
				openView.usuView('company_visit_edit.html', 'company_visit_edit', {
					companyUid: companyUid,
					type: true
				});
			});
			//查看拜访记录
			function open_detail(data) {
				var databases = JSON.stringify(data);
				openView.usuView('company_visit.html', 'company_visit', {
					database: databases
				});
			}
			//更多拜访记录
			mui('.content-body').on('tap', '.look-more', function() {
				var companyUid = database.uuid;
				openView.usuView('company_visit_list.html', 'company_visit_list', {
					companyUid: companyUid
				});
			})
		</script>
	</body>

</html>